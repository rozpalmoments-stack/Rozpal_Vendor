<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Vendor Details</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
:root {
  --bg: #f4f6f9; --card: #fff; --text: #333; --muted: #555; --border: #dcdfe4;
  --primary: #4caf50; --primary-hover: #45a049; --warn: #ff8c00;
  --success: #2e7d32; --error: #c62828;
}
* { box-sizing: border-box; }
body {
  font-family: system-ui, sans-serif;
  background: var(--bg);
  min-height: 100vh;
  margin: 0;
  display: grid;
  place-items: center;
  padding: 24px;
}
.card { width: 100%; max-width: 420px; background: var(--card); border-radius: 16px;
  padding: 28px; box-shadow: 0 10px 30px rgba(0,0,0,.08); }
h2 { text-align: center; margin: 0 0 18px; color: var(--text); }
.field { margin-bottom: 14px; }
.field label { font-size: 13px; font-weight: 600; color: var(--muted); display: block; margin-bottom: 6px; }
.input, .file { width: 100%; padding: 10px 12px; border: 1px solid var(--border); border-radius: 10px; font-size: 14px; }
.btn { width: 100%; padding: 12px; border: 0; border-radius: 10px; font-weight: 700; font-size: 15px; cursor: pointer; color: #fff; background: var(--primary); }
.btn:hover { background: var(--primary-hover); }
.msg { margin-top: 14px; font-size: 14px; font-weight: 700; display: none; }
.msg.show { display: block; }
.msg.loading { color: var(--warn); }
.msg.success { color: var(--success); }
.msg.error { color: var(--error); }
.small { text-align: center; color: #6a7280; font-size: 12px; margin-top: 10px; }
</style>
</head>
<body>
<div class="card">
  <h2>Vendor Details</h2>

  <form id="vendorForm" novalidate>
    <div class="field"><label for="vendorId">Vendor ID *</label><input id="vendorId" class="input" type="text" required /></div>
    <div class="field"><label for="name">Name *</label><input id="name" class="input" type="text" required /></div>
    <div class="field"><label for="phone">Phone Number *</label><input id="phone" class="input" type="tel" pattern="[0-9]{10}" required /></div>
    <div class="field"><label for="age">Age *</label><input id="age" class="input" type="number" min="18" max="100" required /></div>
    <div class="field"><label for="exp">Experience (Years) *</label><input id="exp" class="input" type="number" min="0" max="60" required /></div>
    <div class="field"><label for="file">Aadhaar/Photo (optional)</label><input id="file" class="file" type="file" accept="image/*,application/pdf" /></div>
    <button class="btn" type="submit">Submit</button>
    <div id="response" class="msg"></div>
    <div class="small">* Required fields</div>
  </form>
</div>

<script>
const scriptURL = "https://script.google.com/macros/s/AKfycbwqKmTfZeVtxSdQzD7j6WeBwGfhKOgWlO0MOysmvpAHE_CCOzlw1g9GgIJ4NSaK76za/exec"; // replace with your Apps Script URL
const form = document.getElementById("vendorForm");
const responseEl = document.getElementById("response");

form.addEventListener("submit", async (e) => {
  e.preventDefault();

  const name = document.getElementById("name").value.trim();
  const phone = document.getElementById("phone").value.trim();
  const age = document.getElementById("age").value.trim();
  const exp = document.getElementById("exp").value.trim();
  const vendorId = document.getElementById("vendorId").value.trim();
  const fileInput = document.getElementById("file").files[0];

  if (!name || !phone || !age || !exp || !vendorId) {
    return showMsg("❌ Please fill all required fields.", "error");
  }

  if (!/^[0-9]{10}$/.test(phone)) return showMsg("❌ Invalid phone.", "error");

  showMsg("⏳ Submitting...", "loading");

  try {
    const payload = { name, phone, age, exp, vendorId };
    if (fileInput) {
      const base64 = await fileToBase64(fileInput);
      payload.file = base64.split(",")[1];
      payload.filename = fileInput.name;
      payload.mimeType = fileInput.type || "application/octet-stream";
    }

    const body = new URLSearchParams(payload);
    const res = await fetch(scriptURL, { method: "POST", body });
    const json = await res.json();

    if (res.ok && json.result === "success") {
      showMsg("✅ Submitted successfully!", "success");
      form.reset();
      setTimeout(clearMsg, 3000);
    } else {
      showMsg("❌ " + (json.message || "Unknown error"), "error");
    }
  } catch (err) {
    console.error(err);
    showMsg("❌ Error submitting. Try again!", "error");
  }
});

function showMsg(text, kind) {
  responseEl.textContent = text;
  responseEl.className = "msg show " + kind;
}

function clearMsg() {
  responseEl.textContent = "";
  responseEl.className = "msg";
}

function fileToBase64(file) {
  return new Promise((resolve, reject) => {
    const reader = new FileReader();
    reader.onload = () => resolve(reader.result);
    reader.onerror = reject;
    reader.readAsDataURL(file);
  });
}
</script>
</body>
</html>
